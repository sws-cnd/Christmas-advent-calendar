<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chocolate Advent Calendar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --christmas-red: #b71c1c;
      --christmas-green: #1b5e20;
      --gold: #d4af37;
    }

    body {
      font-family: system-ui, sans-serif;
      text-align: center;
      padding: 2rem;
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top left, #ffebee 0, #fce4ec 35%, #e8f5e9 75%, #c8e6c9 100%);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .card {
      background: rgba(255, 255, 255, 0.95);
      border: 2px solid var(--christmas-red);
      border-radius: 16px;
      padding: 1.75rem 1.5rem 2rem;
      max-width: 380px;
      width: 100%;
      margin: 0 auto;
      box-shadow: 0 10px 25px rgba(0,0,0,0.12);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      top: 0;
      left: -10%;
      width: 120%;
      height: 8px;
      background: linear-gradient(90deg, var(--christmas-red), var(--gold), var(--christmas-green));
    }

    h1 {
      font-size: 1.6rem;
      margin-bottom: 0.75rem;
      color: var(--christmas-red);
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    h1 .title-line-small {
      display: block;
      font-size: 1.3rem;
    }

    h1 .title-line-main {
      display: block;
      font-size: 1.9rem;
      margin: 0.2rem 0;
      color: var(--christmas-red);
    }

    h1 .title-main-row {
      display: block;
      line-height: 1.2;
    }

    h2 {
      font-size: 1.2rem;
      margin: 0.75rem 0 0.25rem;
      color: var(--christmas-green);
    }

    .small {
      font-size: 0.85rem;
      color: #555;
    }

    .chocolates {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1.25rem;
      flex-wrap: wrap;
    }

    .choc {
      display: flex;
      flex-direction: column;
      align-items: center;
      max-width: 120px;
      padding: 0.5rem;
      border-radius: 12px;
      background: #fafafa;
      border: 1px solid rgba(0,0,0,0.05);
      box-shadow: 0 3px 8px rgba(0,0,0,0.06);
    }

    .choc img {
      width: 120px;
      height: 120px;
      object-fit: cover;
      border-radius: 12px;
      border: 2px solid var(--christmas-green);
      margin-bottom: 0.5rem;
      background: #fff;
    }

    .choc span {
      font-size: 0.9rem;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>
      <span class="title-line-small">â¤ï¸ ğŸ ğŸ« ğŸ„ ğŸ… ğŸ« ğŸ â¤ï¸</span><br>

      <span class="title-line-main">
        <span class="title-main-row">â¤ï¸ Sumika's â¤ï¸</span>
        <span class="title-main-row">ğŸ„ Advent ğŸ„</span>
        <span class="title-main-row">ğŸ¬ Calendar ğŸ¬</span>
      </span><br>

      <span class="title-line-small">â¤ï¸ ğŸ ğŸ« ğŸ… ğŸ„ ğŸ« ğŸ â¤ï¸</span>
    </h1>

    <p class="small" id="date-info"></p>
    <h2 id="message"></h2>
    <div class="chocolates" id="chocolate-container"></div>
  </div>

  <script>
    // 1) Advent window (25 days)
    const adventStart = new Date("2025-12-01T00:00:00");
    const adventEnd   = new Date("2025-12-26T00:00:00"); // exclusive (25 days)

    // 2) Chocolate metadata (with Santa)
    const chocolates = {
      Dark_Milk:          { name: "Milka Dark Milk",                  imageUrl: "Dark milk.png" },
      Alpen_Milk:         { name: "Milka Alpen Milk",                 imageUrl: "Aplen Milk.png" },
      Noisette_Hazelnut:  { name: "Milka Noisette Hazelnut",          imageUrl: "Noisette hazelnut.png" },
      Lebkuchen:          { name: "Milka Lebkuchen",                  imageUrl: "Lebkuchen.png" },
      Marzipan:           { name: "Milka Marzipan",                   imageUrl: "Marzipan.png" },
      Nougat_karamell:    { name: "Milka Nougat mit KaramellstÃ¼cken", imageUrl: "Nougat Creme mit KaramellstÃ¼cken.png" },
      Santa_Chocolate:    { name: "Milka Santa Biscoff ğŸ…",           imageUrl: "Biscoff Santa.png" }
    };

    // 3) Precomputed schedule with Day 25 added
    const schedule = [
      ["Dark_Milk",         "Lebkuchen"],          
      ["Marzipan",          "Nougat_karamell"],    
      ["Dark_Milk",         "Noisette_Hazelnut"],  
      ["Lebkuchen",         "Marzipan"],           
      ["Dark_Milk",         "Alpen_Milk"],         
      ["Lebkuchen",         "Nougat_karamell"],    
      ["Dark_Milk",         "Alpen_Milk"],         
      ["Marzipan",          "Nougat_karamell"],    
      ["Noisette_Hazelnut", "Lebkuchen"],          
      ["Dark_Milk",         "Alpen_Milk"],         
      ["Lebkuchen",         "Marzipan"],           
      ["Alpen_Milk",        "Nougat_karamell"],    
      ["Noisette_Hazelnut", "Marzipan"],           
      ["Dark_Milk",         "Alpen_Milk"],         
      ["Noisette_Hazelnut", "Marzipan"],           
      ["Dark_Milk",         "Lebkuchen"],          
      ["Alpen_Milk",        "Noisette_Hazelnut"],  
      ["Marzipan",          "Nougat_karamell"],    
      ["Noisette_Hazelnut", "Lebkuchen"],          
      ["Alpen_Milk",        "Nougat_karamell"],    
      ["Dark_Milk",         "Noisette_Hazelnut"],  
      ["Lebkuchen",         "Nougat_karamell"],    
      ["Alpen_Milk",        "Noisette_Hazelnut"],  
      ["Marzipan",          "Nougat_karamell"],    
      ["Santa_Chocolate"]                          // ğŸ… Day 25
    ];

    function floorDaysBetween(d1, d2) {
      const msPerDay = 24 * 60 * 60 * 1000;
      const utc1 = Date.UTC(d1.getFullYear(), d1.getMonth(), d1.getDate());
      const utc2 = Date.UTC(d2.getFullYear(), d2.getMonth(), d2.getDate());
      return Math.floor((utc2 - utc1) / msPerDay);
    }

    const today = new Date();
    const dateInfoEl = document.getElementById("date-info");
    const messageEl = document.getElementById("message");
    const containerEl = document.getElementById("chocolate-container");

    if (today < adventStart) {
      dateInfoEl.textContent = today.toDateString();
      messageEl.textContent = "The calendar has not started yet. Come back on the first day of your calendar. ğŸ¤—";
    } else if (today >= adventEnd) {
      dateInfoEl.textContent = today.toDateString();
      messageEl.textContent = "The calendar is finished! You have eaten all the chocolates. ğŸ¤­ ğŸ";
    } else {
      const dayIndex = floorDaysBetween(adventStart, today);
      const dayNumber = dayIndex + 1;
      const todaysChocolates = schedule[dayIndex];

      // New text for the day line
      dateInfoEl.textContent = `Day ${dayNumber} of your advent.`;

      // Track if today's chocolates were already opened on this device
      const STORAGE_KEY = "sumika_advent_open_state_v1";
      let state = null;
      try {
        state = JSON.parse(localStorage.getItem(STORAGE_KEY));
      } catch (e) {
        state = null;
      }
      if (!state) {
        state = { dayNumber: null };
      }

      const alreadyOpenedToday = state.dayNumber === dayNumber;
      const isSantaDay = todaysChocolates.length === 1; // Day 25

      if (alreadyOpenedToday) {
        if (isSantaDay) {
          // Last day: always nice, no greedy message
          messageEl.textContent = "ğŸ„ Merry Christmas! Your special Santa chocolate ğŸ…";
        } else {
          // Days 1â€“24: greedy warning on second/later open
          messageEl.textContent = "Today's chocolates are in your stomach. ğŸ˜— No more today. ğŸ˜ ğŸ¤«";
        }
      } else {
        // First open today
        if (isSantaDay) {
          messageEl.textContent = "ğŸ„ Merry Christmas! Your special Santa chocolate ğŸ…";
        } else {
          // New regular-day message
          messageEl.textContent = "Today's chocolate surprise by me for you ğŸ˜˜";
        }

        // Save that this day has been opened
        const newState = { dayNumber };
        try {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(newState));
        } catch (e) {
          // Ignore storage errors (e.g. private mode)
        }
      }

      // Always show today's chocolates (first or later open)
      todaysChocolates.forEach(id => {
        const choc = chocolates[id];
        if (!choc) return;

        const div = document.createElement("div");
        div.className = "choc";

        const img = document.createElement("img");
        img.src = choc.imageUrl;
        img.alt = choc.name;

        const label = document.createElement("span");
        label.textContent = choc.name;

        div.appendChild(img);
        div.appendChild(label);
        containerEl.appendChild(div);
      });
    }
  </script>
</body>
</html>


